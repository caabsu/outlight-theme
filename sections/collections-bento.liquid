{%- comment -%}
  Collections Bento Grid
  A visually appealing bento-style grid layout for showcasing collections
{%- endcomment -%}

<section class="collections-bento" style="
  --cb-gap: {{ section.settings.grid_gap }}px;
  --cb-title-size-desktop: {{ section.settings.title_font_size_desktop }}px;
  --cb-title-size-mobile: {{ section.settings.title_font_size_mobile }}px;
  --cb-btn-opacity: {{ section.settings.button_opacity | divided_by: 100.0 }};
  --cb-btn-text: {{ section.settings.button_text_color }};
  --cb-btn-bg: {{ section.settings.button_background }};
  --cb-btn-size: {{ section.settings.button_font_size }}px;
  --cb-btn-weight: {{ section.settings.button_font_weight }};
  --cb-btn-image-opacity: {{ section.settings.button_image_opacity | divided_by: 100.0 }};
  --cb-section-title-size: {{ section.settings.section_title_size }}px;
  --cb-section-title-color: {{ section.settings.section_title_color }};
  --cb-section-title-weight: {{ section.settings.section_title_weight }};
  --cb-section-height: {{ section.settings.section_height }}px;
  --cb-padding-top-desktop: {{ section.settings.padding_top_desktop }}px;
  --cb-padding-bottom-desktop: {{ section.settings.padding_bottom_desktop }}px;
  --cb-padding-top-mobile: {{ section.settings.padding_top_mobile }}px;
  --cb-padding-bottom-mobile: {{ section.settings.padding_bottom_mobile }}px;
">
  {%- if section.settings.show_section_title -%}
    <h2 class="collections-bento__section-title">{{ section.settings.section_title }}</h2>
  {%- endif -%}

  <div class="collections-bento__grid">
    {%- comment -%} Collection 1 - Large Left {%- endcomment -%}
    {%- if section.settings.collection_1 != blank -%}
      {%- assign collection_1 = section.settings.collection_1 -%}
      <a href="{{ collection_1.url }}" class="collections-bento__item collections-bento__item--large">
        {%- if section.settings.image_1_mobile != blank -%}
          <picture>
            <source media="(min-width: 768px)" srcset="{{ section.settings.image_1 | default: section.settings.image_1_mobile | image_url: width: 800 }}">
            {{ section.settings.image_1_mobile | image_url: width: 600 | image_tag: class: 'collections-bento__image', loading: 'lazy' }}
          </picture>
        {%- elsif section.settings.image_1 != blank -%}
          {{ section.settings.image_1 | image_url: width: 800 | image_tag: class: 'collections-bento__image', loading: 'lazy' }}
        {%- elsif collection_1.featured_image -%}
          {{ collection_1.featured_image | image_url: width: 800 | image_tag: class: 'collections-bento__image', loading: 'lazy' }}
        {%- else -%}
          <div class="collections-bento__placeholder"></div>
        {%- endif -%}
        <span class="collections-bento__title">{{ section.settings.title_1 | default: collection_1.title }}</span>
      </a>
    {%- endif -%}

    {%- comment -%} Collection 2 - Wide Top Middle {%- endcomment -%}
    {%- if section.settings.collection_2 != blank -%}
      {%- assign collection_2 = section.settings.collection_2 -%}
      <a href="{{ collection_2.url }}" class="collections-bento__item collections-bento__item--wide-top">
        {%- if section.settings.image_2_mobile != blank -%}
          <picture>
            <source media="(min-width: 768px)" srcset="{{ section.settings.image_2 | default: section.settings.image_2_mobile | image_url: width: 1000 }}">
            {{ section.settings.image_2_mobile | image_url: width: 800 | image_tag: class: 'collections-bento__image', loading: 'lazy' }}
          </picture>
        {%- elsif section.settings.image_2 != blank -%}
          {{ section.settings.image_2 | image_url: width: 1000 | image_tag: class: 'collections-bento__image', loading: 'lazy' }}
        {%- elsif collection_2.featured_image -%}
          {{ collection_2.featured_image | image_url: width: 1000 | image_tag: class: 'collections-bento__image', loading: 'lazy' }}
        {%- else -%}
          <div class="collections-bento__placeholder"></div>
        {%- endif -%}
        <span class="collections-bento__title">{{ section.settings.title_2 | default: collection_2.title }}</span>
      </a>
    {%- endif -%}

    {%- comment -%} Collection 3 - Top Right {%- endcomment -%}
    {%- if section.settings.collection_3 != blank -%}
      {%- assign collection_3 = section.settings.collection_3 -%}
      <a href="{{ collection_3.url }}" class="collections-bento__item collections-bento__item--top-right">
        {%- if section.settings.image_3_mobile != blank -%}
          <picture>
            <source media="(min-width: 768px)" srcset="{{ section.settings.image_3 | default: section.settings.image_3_mobile | image_url: width: 600 }}">
            {{ section.settings.image_3_mobile | image_url: width: 400 | image_tag: class: 'collections-bento__image', loading: 'lazy' }}
          </picture>
        {%- elsif section.settings.image_3 != blank -%}
          {{ section.settings.image_3 | image_url: width: 600 | image_tag: class: 'collections-bento__image', loading: 'lazy' }}
        {%- elsif collection_3.featured_image -%}
          {{ collection_3.featured_image | image_url: width: 600 | image_tag: class: 'collections-bento__image', loading: 'lazy' }}
        {%- else -%}
          <div class="collections-bento__placeholder"></div>
        {%- endif -%}
        <span class="collections-bento__title">{{ section.settings.title_3 | default: collection_3.title }}</span>
      </a>
    {%- endif -%}

    {%- comment -%} Collection 4 - Bottom Middle {%- endcomment -%}
    {%- if section.settings.collection_4 != blank -%}
      {%- assign collection_4 = section.settings.collection_4 -%}
      <a href="{{ collection_4.url }}" class="collections-bento__item collections-bento__item--wide-bottom">
        {%- if section.settings.image_4_mobile != blank -%}
          <picture>
            <source media="(min-width: 768px)" srcset="{{ section.settings.image_4 | default: section.settings.image_4_mobile | image_url: width: 1000 }}">
            {{ section.settings.image_4_mobile | image_url: width: 400 | image_tag: class: 'collections-bento__image', loading: 'lazy' }}
          </picture>
        {%- elsif section.settings.image_4 != blank -%}
          {{ section.settings.image_4 | image_url: width: 1000 | image_tag: class: 'collections-bento__image', loading: 'lazy' }}
        {%- elsif collection_4.featured_image -%}
          {{ collection_4.featured_image | image_url: width: 1000 | image_tag: class: 'collections-bento__image', loading: 'lazy' }}
        {%- else -%}
          <div class="collections-bento__placeholder"></div>
        {%- endif -%}
        <span class="collections-bento__title">{{ section.settings.title_4 | default: collection_4.title }}</span>
      </a>
    {%- endif -%}

    {%- comment -%} View All Button - Desktop {%- endcomment -%}
    {%- if section.settings.show_view_all -%}
      <a href="{{ section.settings.view_all_url | default: routes.collections_url }}" class="collections-bento__item collections-bento__item--button">
        {%- if section.settings.button_image != blank -%}
          {{ section.settings.button_image | image_url: width: 600 | image_tag: class: 'collections-bento__button-image', loading: 'lazy' }}
        {%- endif -%}
        <div class="collections-bento__button-content">
          <span class="collections-bento__button-text">{{ section.settings.button_text }}</span>
          <svg class="collections-bento__button-arrow" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M4 10h12M12 6l4 4-4 4"/>
          </svg>
        </div>
      </a>
    {%- endif -%}
  </div>

  {%- comment -%} View All Button - Mobile {%- endcomment -%}
  {%- if section.settings.show_view_all and section.settings.show_mobile_button -%}
    <a href="{{ section.settings.view_all_url | default: routes.collections_url }}" class="collections-bento__mobile-button">
      {%- if section.settings.button_image_mobile != blank -%}
        {{ section.settings.button_image_mobile | image_url: width: 800 | image_tag: class: 'collections-bento__mobile-button-image', loading: 'lazy' }}
      {%- endif -%}
      <div class="collections-bento__mobile-button-content">
        <span>{{ section.settings.button_text }}</span>
        <svg width="16" height="16" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M4 10h12M12 6l4 4-4 4"/>
        </svg>
      </div>
    </a>
  {%- endif -%}
</section>

{% stylesheet %}
  .collections-bento {
    width: 100%;
    padding: var(--cb-padding-top-mobile, 40px) 0 var(--cb-padding-bottom-mobile, 40px);
  }

  .collections-bento__section-title {
    display: block;
    font-family: var(--font-heading-family), serif;
    font-size: var(--cb-section-title-size, 28px);
    font-weight: var(--cb-section-title-weight, 400);
    color: var(--cb-section-title-color, #1C1917);
    margin: 0 0 16px;
    text-align: left;
  }

  /* Mobile Grid */
  .collections-bento__grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto auto auto;
    gap: var(--cb-gap, 12px);
  }

  .collections-bento__item {
    position: relative;
    display: block;
    overflow: hidden;
    text-decoration: none;
  }

  /* Mobile: Collection 1 - Full width top */
  .collections-bento__item--large {
    grid-column: 1 / -1;
    aspect-ratio: 4/3;
  }

  /* Mobile: Collection 3 & 4 side by side */
  .collections-bento__item--top-right {
    grid-column: 1;
    aspect-ratio: 1;
  }

  .collections-bento__item--wide-bottom {
    grid-column: 2;
    aspect-ratio: 1;
  }

  /* Mobile: Collection 2 - Full width */
  .collections-bento__item--wide-top {
    grid-column: 1 / -1;
    aspect-ratio: 16/9;
    order: 3;
  }

  /* Hide desktop button on mobile */
  .collections-bento__item--button {
    display: none;
  }

  .collections-bento__image {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.4s ease;
  }

  .collections-bento__item:hover .collections-bento__image {
    transform: scale(1.03);
  }

  .collections-bento__placeholder {
    position: absolute;
    inset: 0;
    background: #E7E5E4;
  }

  .collections-bento__title {
    position: absolute;
    bottom: 16px;
    left: 16px;
    font-family: var(--font-heading-family), serif;
    font-size: var(--cb-title-size-mobile, 20px);
    font-weight: 400;
    color: #ffffff;
    text-shadow: 0 1px 3px rgba(0,0,0,0.3);
    z-index: 1;
  }

  /* Mobile View All Button */
  .collections-bento__mobile-button {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    margin-top: var(--cb-gap, 12px);
    padding: 12px 20px;
    background: var(--cb-btn-bg, #D6D3D1);
    text-decoration: none;
    overflow: hidden;
  }

  .collections-bento__mobile-button-image {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: var(--cb-btn-image-opacity, 1);
  }

  .collections-bento__mobile-button-content {
    position: relative;
    z-index: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    color: var(--cb-btn-text, #44403C);
    font-family: var(--font-body-family), sans-serif;
    font-size: var(--cb-btn-size, 14px);
    font-weight: var(--cb-btn-weight, 500);
  }

  .collections-bento__mobile-button-content svg {
    color: #B45309;
  }

  /* Desktop Layout */
  @media (min-width: 768px) {
    .collections-bento {
      padding: var(--cb-padding-top-desktop, 60px) 40px var(--cb-padding-bottom-desktop, 60px);
    }

    .collections-bento__section-title {
      display: none;
    }

    .collections-bento__mobile-button {
      display: none;
    }

    .collections-bento__grid {
      display: grid;
      grid-template-columns: 1fr 1.6fr 0.8fr;
      grid-template-rows: 1fr 1fr;
      height: var(--cb-section-height, 600px);
      gap: var(--cb-gap, 16px);
    }

    .collections-bento__item {
      aspect-ratio: unset;
      height: 100%;
    }

    /* Desktop: Collection 1 - Large Left (spans both rows) */
    .collections-bento__item--large {
      grid-column: 1;
      grid-row: 1 / 3;
    }

    /* Desktop: Collection 2 - Wide Top Middle */
    .collections-bento__item--wide-top {
      grid-column: 2;
      grid-row: 1;
      order: unset;
    }

    /* Desktop: Collection 3 - Top Right */
    .collections-bento__item--top-right {
      grid-column: 3;
      grid-row: 1;
    }

    /* Desktop: Collection 4 - Bottom Middle */
    .collections-bento__item--wide-bottom {
      grid-column: 2;
      grid-row: 2;
    }

    /* Desktop: View All Button - Bottom Right */
    .collections-bento__item--button {
      grid-column: 3;
      grid-row: 2;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--cb-btn-bg, #D6D3D1);
      overflow: hidden;
    }

    .collections-bento__button-image {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: var(--cb-btn-image-opacity, 1);
    }

    .collections-bento__button-content {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 12px;
    }

    .collections-bento__button-text {
      font-family: var(--font-body-family), sans-serif;
      font-size: var(--cb-btn-size, 14px);
      font-weight: var(--cb-btn-weight, 500);
      color: var(--cb-btn-text, #44403C);
      text-align: center;
      line-height: 1.4;
    }

    .collections-bento__button-arrow {
      color: #B45309;
    }

    .collections-bento__title {
      font-size: var(--cb-title-size-desktop, 28px);
      bottom: 24px;
      left: 24px;
    }
  }

  @media (min-width: 1200px) {
    .collections-bento {
      padding: var(--cb-padding-top-desktop, 60px) 60px var(--cb-padding-bottom-desktop, 60px);
    }

    .collections-bento__grid {
      gap: var(--cb-gap, 20px);
    }

    .collections-bento__title {
      bottom: 32px;
      left: 32px;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Collections Bento Grid",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "section_height",
      "label": "Section height (desktop)",
      "min": 400,
      "max": 900,
      "step": 50,
      "unit": "px",
      "default": 600
    },
    {
      "type": "range",
      "id": "grid_gap",
      "label": "Grid gap",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 16
    },
    {
      "type": "header",
      "content": "Padding (Desktop)"
    },
    {
      "type": "range",
      "id": "padding_top_desktop",
      "label": "Padding top",
      "min": 0,
      "max": 150,
      "step": 10,
      "unit": "px",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom_desktop",
      "label": "Padding bottom",
      "min": 0,
      "max": 150,
      "step": 10,
      "unit": "px",
      "default": 60
    },
    {
      "type": "header",
      "content": "Padding (Mobile)"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "label": "Padding top",
      "min": 0,
      "max": 100,
      "step": 10,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "label": "Padding bottom",
      "min": 0,
      "max": 100,
      "step": 10,
      "unit": "px",
      "default": 40
    },
    {
      "type": "header",
      "content": "Section Title (Mobile)"
    },
    {
      "type": "checkbox",
      "id": "show_section_title",
      "label": "Show section title",
      "default": true
    },
    {
      "type": "text",
      "id": "section_title",
      "label": "Title text",
      "default": "Collections"
    },
    {
      "type": "range",
      "id": "section_title_size",
      "label": "Title size",
      "min": 20,
      "max": 48,
      "step": 2,
      "unit": "px",
      "default": 28
    },
    {
      "type": "color",
      "id": "section_title_color",
      "label": "Title color",
      "default": "#1C1917"
    },
    {
      "type": "select",
      "id": "section_title_weight",
      "label": "Title weight",
      "options": [
        { "value": "300", "label": "Light" },
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semibold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "400"
    },
    {
      "type": "header",
      "content": "Collection Titles"
    },
    {
      "type": "range",
      "id": "title_font_size_desktop",
      "label": "Title size (desktop)",
      "min": 16,
      "max": 48,
      "step": 2,
      "unit": "px",
      "default": 28
    },
    {
      "type": "range",
      "id": "title_font_size_mobile",
      "label": "Title size (mobile)",
      "min": 14,
      "max": 32,
      "step": 2,
      "unit": "px",
      "default": 20
    },
    {
      "type": "header",
      "content": "Collection 1 (Large left)"
    },
    {
      "type": "collection",
      "id": "collection_1",
      "label": "Collection"
    },
    {
      "type": "text",
      "id": "title_1",
      "label": "Custom title"
    },
    {
      "type": "image_picker",
      "id": "image_1",
      "label": "Desktop image"
    },
    {
      "type": "image_picker",
      "id": "image_1_mobile",
      "label": "Mobile image"
    },
    {
      "type": "header",
      "content": "Collection 2 (Wide top)"
    },
    {
      "type": "collection",
      "id": "collection_2",
      "label": "Collection"
    },
    {
      "type": "text",
      "id": "title_2",
      "label": "Custom title"
    },
    {
      "type": "image_picker",
      "id": "image_2",
      "label": "Desktop image"
    },
    {
      "type": "image_picker",
      "id": "image_2_mobile",
      "label": "Mobile image"
    },
    {
      "type": "header",
      "content": "Collection 3 (Top right)"
    },
    {
      "type": "collection",
      "id": "collection_3",
      "label": "Collection"
    },
    {
      "type": "text",
      "id": "title_3",
      "label": "Custom title"
    },
    {
      "type": "image_picker",
      "id": "image_3",
      "label": "Desktop image"
    },
    {
      "type": "image_picker",
      "id": "image_3_mobile",
      "label": "Mobile image"
    },
    {
      "type": "header",
      "content": "Collection 4 (Bottom middle)"
    },
    {
      "type": "collection",
      "id": "collection_4",
      "label": "Collection"
    },
    {
      "type": "text",
      "id": "title_4",
      "label": "Custom title"
    },
    {
      "type": "image_picker",
      "id": "image_4",
      "label": "Desktop image"
    },
    {
      "type": "image_picker",
      "id": "image_4_mobile",
      "label": "Mobile image"
    },
    {
      "type": "header",
      "content": "View All Button"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show view all button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_mobile_button",
      "label": "Show button on mobile",
      "default": true
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "View All Collections"
    },
    {
      "type": "url",
      "id": "view_all_url",
      "label": "Button link"
    },
    {
      "type": "header",
      "content": "Button Style"
    },
    {
      "type": "color",
      "id": "button_background",
      "label": "Background color",
      "default": "#D6D3D1"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Text color",
      "default": "#44403C"
    },
    {
      "type": "range",
      "id": "button_font_size",
      "label": "Font size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "select",
      "id": "button_font_weight",
      "label": "Font weight",
      "options": [
        { "value": "300", "label": "Light" },
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semibold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "500"
    },
    {
      "type": "range",
      "id": "button_opacity",
      "label": "Background opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 100
    },
    {
      "type": "header",
      "content": "Button Image (Desktop)"
    },
    {
      "type": "image_picker",
      "id": "button_image",
      "label": "Background image"
    },
    {
      "type": "range",
      "id": "button_image_opacity",
      "label": "Image opacity",
      "min": 10,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 100
    },
    {
      "type": "header",
      "content": "Button Image (Mobile)"
    },
    {
      "type": "image_picker",
      "id": "button_image_mobile",
      "label": "Background image"
    }
  ],
  "presets": [
    {
      "name": "Collections Bento Grid"
    }
  ]
}
{% endschema %}

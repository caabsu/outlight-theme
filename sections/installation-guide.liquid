<div
  class="installation-guide full-width"
  style="
    --section-padding-top: {{ section.settings.section_padding_top }}px;
    --section-padding-bottom: {{ section.settings.section_padding_bottom }}px;
    --section-bg: {{ section.settings.section_bg }};
    --card-bg: {{ section.settings.card_bg }};
    --card-radius: {{ section.settings.card_radius }}px;
    --card-padding-desktop: {{ section.settings.card_padding_desktop }}px;
    --card-padding-mobile: {{ section.settings.card_padding_mobile }}px;
    --label-bg: {{ section.settings.label_bg }};
    --label-color: {{ section.settings.label_color }};
    --label-size: {{ section.settings.label_size }}px;
    --desktop-text-size: {{ section.settings.desktop_text_size }}px;
    --desktop-text-weight: {{ section.settings.desktop_text_weight }};
    --desktop-text-color: {{ section.settings.desktop_text_color }};
    --desktop-line-height: {{ section.settings.desktop_line_height }};
    --mobile-text-size: {{ section.settings.mobile_text_size }}px;
    --mobile-text-weight: {{ section.settings.mobile_text_weight }};
    --mobile-text-color: {{ section.settings.mobile_text_color }};
    --mobile-line-height: {{ section.settings.mobile_line_height }};
    --mobile-label-size: {{ section.settings.mobile_label_size }}px;
    --mobile-label-weight: {{ section.settings.mobile_label_weight }};
    --mobile-label-color: {{ section.settings.mobile_label_color }};
  "
>
  <div class="installation-guide__container">
    <!-- Desktop Layout -->
    <div class="installation-guide__card installation-guide__card--desktop">
      <div class="installation-guide__label">
        {{ section.settings.desktop_label }}
      </div>
      <div class="installation-guide__content">
        {%- if product.metafields.custom.installation_guide != blank -%}
          {{ product.metafields.custom.installation_guide | metafield_tag }}
        {%- else -%}
          {{ section.settings.fallback_text }}
        {%- endif -%}
      </div>
    </div>

    <!-- Mobile Layout - Collapsible Tab -->
    <details class="installation-guide__accordion">
      <summary class="installation-guide__accordion-header">
        <span class="installation-guide__accordion-title">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
          </svg>
          {{ section.settings.mobile_label }}
        </span>
        <span class="installation-guide__accordion-icon">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
            <line class="installation-guide__icon-h" x1="4" y1="10" x2="16" y2="10"/>
            <line class="installation-guide__icon-v" x1="10" y1="4" x2="10" y2="16"/>
          </svg>
        </span>
      </summary>
      <div class="installation-guide__accordion-content">
        {%- if product.metafields.custom.installation_guide != blank -%}
          {{ product.metafields.custom.installation_guide | metafield_tag }}
        {%- else -%}
          {{ section.settings.fallback_text }}
        {%- endif -%}
      </div>
    </details>
  </div>
</div>

{% stylesheet %}
  .installation-guide {
    background: var(--section-bg);
    padding: var(--section-padding-top) 0 var(--section-padding-bottom) 0;
  }

  .installation-guide__container {
    max-width: var(--page-width);
    margin: 0 auto;
    padding: 0 24px;
  }

  .installation-guide__card {
    background: var(--card-bg);
    border-radius: var(--card-radius);
    position: relative;
  }

  .installation-guide__card--desktop {
    display: block;
    padding: var(--card-padding-desktop);
    padding-top: calc(var(--card-padding-desktop) + 20px);
  }

  .installation-guide__card--mobile {
    display: none;
  }

  .installation-guide__label {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translate(-50%, -50%);
    background: var(--label-bg);
    color: var(--label-color);
    font-size: var(--label-size);
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 10px 24px;
    border-radius: 100px;
    white-space: nowrap;
  }

  .installation-guide__content {
    font-size: var(--desktop-text-size);
    font-weight: var(--desktop-text-weight);
    color: var(--desktop-text-color);
    line-height: var(--desktop-line-height);
    text-align: center;
  }

  /* Mobile Accordion - hidden on desktop */
  .installation-guide__accordion {
    display: none;
  }

  @media (max-width: 768px) {
    .installation-guide {
      padding: var(--section-padding-top) 0 var(--section-padding-bottom) 0;
    }

    .installation-guide__container {
      padding: 0 16px;
    }

    .installation-guide__card--desktop {
      display: none;
    }

    /* Accordion styles */
    .installation-guide__accordion {
      display: block;
      background: var(--card-bg);
    }

    .installation-guide__accordion-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px;
      cursor: pointer;
      list-style: none;
    }

    .installation-guide__accordion-header::-webkit-details-marker {
      display: none;
    }

    .installation-guide__accordion-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: var(--mobile-label-size);
      font-weight: var(--mobile-label-weight);
      color: var(--mobile-label-color);
    }

    .installation-guide__accordion-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      color: #999;
    }

    .installation-guide__icon-v {
      transition: opacity 0.2s ease, transform 0.2s ease;
    }

    .installation-guide__accordion[open] .installation-guide__icon-v {
      opacity: 0;
      transform: scaleY(0);
    }

    .installation-guide__accordion-content {
      padding: 0 16px 16px;
      font-size: var(--mobile-text-size);
      font-weight: var(--mobile-text-weight);
      color: var(--mobile-text-color);
      line-height: var(--mobile-line-height);
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Installation guide",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "desktop_label",
      "label": "Desktop label",
      "default": "INSTRUCTIONS"
    },
    {
      "type": "text",
      "id": "mobile_label",
      "label": "Mobile label",
      "default": "GUIDE"
    },
    {
      "type": "textarea",
      "id": "fallback_text",
      "label": "Fallback text",
      "info": "Shown if metafield is empty",
      "default": "Installation should be performed by a licensed electrician. Begin by turning off power at the main breaker panel."
    },
    {
      "type": "header",
      "content": "Section spacing"
    },
    {
      "type": "range",
      "id": "section_padding_top",
      "label": "Padding top",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 0,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "section_padding_bottom",
      "label": "Padding bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 0,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Section colors"
    },
    {
      "type": "color",
      "id": "section_bg",
      "label": "Section background",
      "default": "#F5F5F5"
    },
    {
      "type": "color",
      "id": "card_bg",
      "label": "Card background",
      "default": "#FAFAF8"
    },
    {
      "type": "range",
      "id": "card_radius",
      "label": "Card border radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "card_padding_desktop",
      "label": "Card padding (desktop)",
      "min": 20,
      "max": 80,
      "step": 4,
      "default": 48,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "card_padding_mobile",
      "label": "Card padding (mobile)",
      "min": 16,
      "max": 48,
      "step": 4,
      "default": 24,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Desktop label"
    },
    {
      "type": "color",
      "id": "label_bg",
      "label": "Background",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "label_color",
      "label": "Text color",
      "default": "#1a1a1a"
    },
    {
      "type": "range",
      "id": "label_size",
      "label": "Font size",
      "min": 10,
      "max": 16,
      "step": 1,
      "default": 12,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Mobile label"
    },
    {
      "type": "range",
      "id": "mobile_label_size",
      "label": "Font size",
      "min": 12,
      "max": 20,
      "step": 1,
      "default": 15,
      "unit": "px"
    },
    {
      "type": "select",
      "id": "mobile_label_weight",
      "label": "Font weight",
      "options": [
        { "value": "300", "label": "Light" },
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semibold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "500"
    },
    {
      "type": "color",
      "id": "mobile_label_color",
      "label": "Text color",
      "default": "#1a1a1a"
    },
    {
      "type": "header",
      "content": "Desktop - Text"
    },
    {
      "type": "range",
      "id": "desktop_text_size",
      "label": "Size",
      "min": 14,
      "max": 24,
      "step": 1,
      "default": 17,
      "unit": "px"
    },
    {
      "type": "select",
      "id": "desktop_text_weight",
      "label": "Weight",
      "options": [
        { "value": "300", "label": "Light" },
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semibold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "400"
    },
    {
      "type": "color",
      "id": "desktop_text_color",
      "label": "Color",
      "default": "#3D3D3D"
    },
    {
      "type": "select",
      "id": "desktop_line_height",
      "label": "Line height",
      "options": [
        { "value": "1.4", "label": "Tight" },
        { "value": "1.6", "label": "Normal" },
        { "value": "1.8", "label": "Relaxed" },
        { "value": "2", "label": "Loose" }
      ],
      "default": "1.8"
    },
    {
      "type": "header",
      "content": "Mobile - Text"
    },
    {
      "type": "range",
      "id": "mobile_text_size",
      "label": "Size",
      "min": 12,
      "max": 20,
      "step": 1,
      "default": 15,
      "unit": "px"
    },
    {
      "type": "select",
      "id": "mobile_text_weight",
      "label": "Weight",
      "options": [
        { "value": "300", "label": "Light" },
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semibold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "400"
    },
    {
      "type": "color",
      "id": "mobile_text_color",
      "label": "Color",
      "default": "#3D3D3D"
    },
    {
      "type": "select",
      "id": "mobile_line_height",
      "label": "Line height",
      "options": [
        { "value": "1.4", "label": "Tight" },
        { "value": "1.6", "label": "Normal" },
        { "value": "1.8", "label": "Relaxed" },
        { "value": "2", "label": "Loose" }
      ],
      "default": "1.6"
    }
  ],
  "presets": [
    {
      "name": "Installation guide"
    }
  ],
  "templates": ["product"]
}
{% endschema %}
